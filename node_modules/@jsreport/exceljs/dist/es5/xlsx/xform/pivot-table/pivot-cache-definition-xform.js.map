{"version":3,"file":"pivot-cache-definition-xform.js","names":["BaseXform","require","CacheField","XmlStream","PivotCacheDefinitionXform","constructor","map","prepare","model","tag","render","xmlStream","sourceSheet","cacheFields","openXml","StdDocAttributes","openNode","_objectSpread","PIVOT_CACHE_DEFINITION_ATTRIBUTES","refreshOnLoad","refreshedBy","refreshedDate","createdVersion","refreshedVersion","minRefreshableVersion","recordCount","length","type","leafNode","ref","dimensions","shortRange","sheet","name","closeNode","count","writeXml","cacheField","join","parseOpen","node","parseText","text","parseClose","reconcile","options","xmlns","module","exports"],"sources":["../../../../../lib/xlsx/xform/pivot-table/pivot-cache-definition-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\nconst CacheField = require('./cache-field');\nconst XmlStream = require('../../../utils/xml-stream');\n\nclass PivotCacheDefinitionXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {};\n  }\n\n  prepare(model) {\n    // TK\n  }\n\n  get tag() {\n    // http://www.datypic.com/sc/ooxml/e-ssml_pivotCacheDefinition.html\n    return 'pivotCacheDefinition';\n  }\n\n  render(xmlStream, model) {\n    const {sourceSheet, cacheFields} = model;\n\n    xmlStream.openXml(XmlStream.StdDocAttributes);\n    xmlStream.openNode(this.tag, {\n      ...PivotCacheDefinitionXform.PIVOT_CACHE_DEFINITION_ATTRIBUTES,\n      'r:id': 'rId1',\n      refreshOnLoad: '1', // important for our implementation to work\n      refreshedBy: 'Author',\n      refreshedDate: '45125.026046874998',\n      createdVersion: '8',\n      refreshedVersion: '8',\n      minRefreshableVersion: '3',\n      recordCount: cacheFields.length + 1,\n    });\n\n    xmlStream.openNode('cacheSource', {type: 'worksheet'});\n    xmlStream.leafNode('worksheetSource', {\n      ref: sourceSheet.dimensions.shortRange,\n      sheet: sourceSheet.name,\n    });\n    xmlStream.closeNode();\n\n    xmlStream.openNode('cacheFields', {count: cacheFields.length});\n    // Note: keeping this pretty-printed for now to ease debugging.\n    xmlStream.writeXml(cacheFields.map(cacheField => new CacheField(cacheField).render()).join('\\n    '));\n    xmlStream.closeNode();\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    // TK\n  }\n\n  parseText(text) {\n    // TK\n  }\n\n  parseClose(name) {\n    // TK\n  }\n\n  reconcile(model, options) {\n    // TK\n  }\n}\n\nPivotCacheDefinitionXform.PIVOT_CACHE_DEFINITION_ATTRIBUTES = {\n  xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n  'xmlns:r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n  'xmlns:mc': 'http://schemas.openxmlformats.org/markup-compatibility/2006',\n  'mc:Ignorable': 'xr',\n  'xmlns:xr': 'http://schemas.microsoft.com/office/spreadsheetml/2014/revision',\n};\n\nmodule.exports = PivotCacheDefinitionXform;\n"],"mappings":";;;;;;;AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,eAAe,CAAC;AAC1C,MAAMC,UAAU,GAAGD,OAAO,CAAC,eAAe,CAAC;AAC3C,MAAME,SAAS,GAAGF,OAAO,CAAC,2BAA2B,CAAC;AAEtD,MAAMG,yBAAyB,SAASJ,SAAS,CAAC;EAChDK,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IAEP,IAAI,CAACC,GAAG,GAAG,CAAC,CAAC;EACf;EAEAC,OAAOA,CAACC,KAAK,EAAE;IACb;EAAA;EAGF,IAAIC,GAAGA,CAAA,EAAG;IACR;IACA,OAAO,sBAAsB;EAC/B;EAEAC,MAAMA,CAACC,SAAS,EAAEH,KAAK,EAAE;IACvB,MAAM;MAACI,WAAW;MAAEC;IAAW,CAAC,GAAGL,KAAK;IAExCG,SAAS,CAACG,OAAO,CAACX,SAAS,CAACY,gBAAgB,CAAC;IAC7CJ,SAAS,CAACK,QAAQ,CAAC,IAAI,CAACP,GAAG,EAAAQ,aAAA,CAAAA,aAAA,KACtBb,yBAAyB,CAACc,iCAAiC;MAC9D,MAAM,EAAE,MAAM;MACdC,aAAa,EAAE,GAAG;MAAE;MACpBC,WAAW,EAAE,QAAQ;MACrBC,aAAa,EAAE,oBAAoB;MACnCC,cAAc,EAAE,GAAG;MACnBC,gBAAgB,EAAE,GAAG;MACrBC,qBAAqB,EAAE,GAAG;MAC1BC,WAAW,EAAEZ,WAAW,CAACa,MAAM,GAAG;IAAC,EACpC,CAAC;IAEFf,SAAS,CAACK,QAAQ,CAAC,aAAa,EAAE;MAACW,IAAI,EAAE;IAAW,CAAC,CAAC;IACtDhB,SAAS,CAACiB,QAAQ,CAAC,iBAAiB,EAAE;MACpCC,GAAG,EAAEjB,WAAW,CAACkB,UAAU,CAACC,UAAU;MACtCC,KAAK,EAAEpB,WAAW,CAACqB;IACrB,CAAC,CAAC;IACFtB,SAAS,CAACuB,SAAS,CAAC,CAAC;IAErBvB,SAAS,CAACK,QAAQ,CAAC,aAAa,EAAE;MAACmB,KAAK,EAAEtB,WAAW,CAACa;IAAM,CAAC,CAAC;IAC9D;IACAf,SAAS,CAACyB,QAAQ,CAACvB,WAAW,CAACP,GAAG,CAAC+B,UAAU,IAAI,IAAInC,UAAU,CAACmC,UAAU,CAAC,CAAC3B,MAAM,CAAC,CAAC,CAAC,CAAC4B,IAAI,CAAC,QAAQ,CAAC,CAAC;IACrG3B,SAAS,CAACuB,SAAS,CAAC,CAAC;IAErBvB,SAAS,CAACuB,SAAS,CAAC,CAAC;EACvB;EAEAK,SAASA,CAACC,IAAI,EAAE;IACd;EAAA;EAGFC,SAASA,CAACC,IAAI,EAAE;IACd;EAAA;EAGFC,UAAUA,CAACV,IAAI,EAAE;IACf;EAAA;EAGFW,SAASA,CAACpC,KAAK,EAAEqC,OAAO,EAAE;IACxB;EAAA;AAEJ;AAEAzC,yBAAyB,CAACc,iCAAiC,GAAG;EAC5D4B,KAAK,EAAE,2DAA2D;EAClE,SAAS,EAAE,qEAAqE;EAChF,UAAU,EAAE,6DAA6D;EACzE,cAAc,EAAE,IAAI;EACpB,UAAU,EAAE;AACd,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG5C,yBAAyB","ignoreList":[]}